<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Fishtank Monitor: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fishtank Monitor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Fishtank Monitor Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>The decomposition of the software can be seen in each of the module pages. Here, we'll cover the dynamic behavior of the system and how it is initialized and does its work. But first we'll cover the basic responsibilities of the main hardware components in the system.</p>
<h1><a class="anchor" id="HW"></a>
The Raspberry Pi and the Alamode</h1>
<p>At the coarsest level, the system breaks down into the two main hardware components: the Raspberry Pi and the Alamode (Arduino-compatible) board.</p>
<h2><a class="anchor" id="Alamode"></a>
The Alamode</h2>
<p>The Alamode is responsible for:</p>
<ul>
<li>receiving configuration parameters from the Raspberry Pi and applying them</li>
<li>periodically taking temperature and ph measurements</li>
<li>updating the LCD display with time/measurements et al</li>
<li>communicating measurement data and logs to the Raspberry Pi</li>
</ul>
<h2><a class="anchor" id="PI"></a>
The Raspberry Pi</h2>
<p>The Raspberry Pi is responsible for:</p>
<ul>
<li>reading configuration parameters frm the config file and making them available to the software components in the system.</li>
<li>managing serial communications, including sending config parameters to the Alamode and subsequently reading measurements data and logs from it</li>
<li>controlling the tank lights on a user-defined schedule</li>
<li>managing the various email notifications, including informational (accompanied by charts) and warnings when tank conditions become unsafe</li>
<li>storing sensor measurement data and some configuration parameters in the sqlite database</li>
</ul>
<h1><a class="anchor" id="Initialization"></a>
Initialization and steady state operation</h1>
<p>In rough detail, the dynamic behavior of the system is presented below.</p>
<h2><a class="anchor" id="Alamode"></a>
The Alamode</h2>
<ul>
<li>The Alamode starts up and configures some aspects of the hardware and then blocks, waiting on JSON-formatted configuration data for the remainder of the hardware <a class="el" href="fish__tank__display_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a></li>
<li>The Alamode then enters a <a class="el" href="fish__tank__display_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> where it periodically:<ul>
<li>updates the LCD with the current time and sensor measurements in <a class="el" href="fish__tank__display_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a></li>
<li>sends the Raspberry Pi JSON-formatted sensor measurements and logs</li>
<li>receives the possibly updated configuration data and applies it</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="Pi"></a>
The Raspberry Pi</h2>
<ul>
<li>The Raspberry Pi reads the config file makes the configuration parameters available</li>
<li>It creates the notifiers used to publish emailed reports and warnings via <a class="el" href="namespacenotifications.html#a9243897dad141dfaa0ef7a19c4ae4dba" title="Lazy instantiator for the global list of functors.">notifications::get_notifiers</a></li>
<li>It creates the <a class="el" href="classserial__monitor_1_1SerialMonitor.html" title="The SerialMonitor manages JSON encoded communications with the alamode.">serial_monitor::SerialMonitor</a> and immediately uses it to send the alamode configuration data</li>
<li>It creates the <a class="el" href="classscheduler_1_1LightScheduler.html" title="The LightScheduler controls the fishtank lights.">scheduler::LightScheduler</a> and starts it to manage the lights</li>
<li>Thereafter, it enters a loop of writing measurement data to the sqlite database, triggering the notifiers and detecting and recovering from certain errors</li>
</ul>
<h2><a class="anchor" id="Acknowledgements"></a>
Acknowledgements</h2>
<p>This software has benefitted from the work of many other open source developers and would have been prohibitively difficult to produce without these other contributions. The table below shows these other packacges and where to find out more about them. I'd also like to express my thanks for the Raspberry Pi, Arduino and Python development communities both in the high quality software they produce and for the wealth of knowledge they share on the Internet.</p>
<h3><a class="anchor" id="Python"></a>
Python</h3>
<table class="doxtable">
<tr>
<th>Package </th><th>Where to Find Out More About It</th></tr>
<tr>
<td>python </td><td><a href="https://www.python.org/">https://www.python.org/</a> </td></tr>
<tr>
<td>schedule </td><td><a href="https://pypi.python.org/pypi/schedule">https://pypi.python.org/pypi/schedule</a> </td></tr>
<tr>
<td>pygal </td><td><a href="http://pygal.org/">http://pygal.org/</a> </td></tr>
<tr>
<td>virtualenv </td><td><a href="https://pypi.python.org/pypi/virtualenv">https://pypi.python.org/pypi/virtualenv</a> </td></tr>
<tr>
<td>pip </td><td><a href="https://pypi.python.org/pypi/pip">https://pypi.python.org/pypi/pip</a> </td></tr>
</table>
<h3><a class="anchor" id="Arduino"></a>
Arduino</h3>
<table class="doxtable">
<tr>
<th>Package </th><th>Where to Find Out More About It</th></tr>
<tr>
<td>Wire </td><td><a href="http://arduino.cc/en/reference/wire">http://arduino.cc/en/reference/wire</a> </td></tr>
<tr>
<td>Time </td><td><a href="http://playground.arduino.cc/code/time">http://playground.arduino.cc/code/time</a> </td></tr>
<tr>
<td>DS1307RTC </td><td><a href="http://www.pjrc.com/teensy/td_libs_DS1307RTC.html">http://www.pjrc.com/teensy/td_libs_DS1307RTC.html</a> </td></tr>
<tr>
<td>Timezone </td><td><a href="https://github.com/JChristensen/Timezone">https://github.com/JChristensen/Timezone</a> </td></tr>
<tr>
<td>LiquidCrystal </td><td><a href="http://arduino.cc/en/Reference/LiquidCrystal">http://arduino.cc/en/Reference/LiquidCrystal</a> </td></tr>
<tr>
<td>LCDKeypad </td><td><a href="http://playground.arduino.cc/Code/LCDkeypad">http://playground.arduino.cc/Code/LCDkeypad</a> </td></tr>
<tr>
<td>ArduinoJson </td><td><a href="https://github.com/bblanchon/ArduinoJson">https://github.com/bblanchon/ArduinoJson</a> </td></tr>
<tr>
<td>arduino ide </td><td><a href="http://arduino.cc/en/main/software">http://arduino.cc/en/main/software</a> </td></tr>
<tr>
<td>ino </td><td><a href="http://inotool.org/">http://inotool.org/</a> </td></tr>
</table>
<h3><a class="anchor" id="General"></a>
General</h3>
<table class="doxtable">
<tr>
<th>Package </th><th>Where to Find Out More About It</th></tr>
<tr>
<td>doxygen </td><td><a href="http://www.stack.nl/~dimitri/doxygen/">http://www.stack.nl/~dimitri/doxygen/</a> </td></tr>
<tr>
<td>graphviz </td><td><a href="http://www.graphviz.org/">http://www.graphviz.org/</a> </td></tr>
<tr>
<td>git </td><td><a href="http://git-scm.com/">http://git-scm.com/</a> </td></tr>
<tr>
<td>github </td><td><a href="http://github.com">http://github.com</a> </td></tr>
<tr>
<td>github pages </td><td><a href="https://pages.github.com/">https://pages.github.com/</a> </td></tr>
<tr>
<td>raspbian </td><td><a href="http://www.raspbian.org/">http://www.raspbian.org/</a> </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 12 2015 19:46:24 for Fishtank Monitor by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
